<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <OutputType>Library</OutputType>
    <TargetFrameworks>$(FullCompatibility)</TargetFrameworks>
    <RootNamespace>NI2S.AssemblyProcessor</RootNamespace>
  </PropertyGroup>

  <ItemGroup>
    <Compile Include="..\..\..\src\NI2S.Framework.Core\Identity\ObjectId.cs" Link="Framework\ObjectId.cs" />
    <Compile Include="..\..\..\src\NI2S.Framework.Core\Identity\ObjectIdBuilder.cs" Link="Framework\ObjectIdBuilder.cs" />
  </ItemGroup>

  <ItemGroup>
    <PackageReference Include="ILRepack" PrivateAssets="All" />
    <PackageReference Include="Microsoft.Build.Utilities.Core" ExcludeAssets="runtime" />
    <PackageReference Include="Mono.Cecil" />
    <PackageReference Include="Mono.Options" />
  </ItemGroup>

  <!-- TODO 1 - BEGIN -->
  <!-- Generate hash file for assembly -->
  <UsingTask TaskName="WriteAllText" TaskFactory="RoslynCodeTaskFactory" AssemblyFile="$(MSBuildToolsPath)\Microsoft.Build.Tasks.Core.dll">
    <ParameterGroup>
      <Path ParameterType="System.String" />
      <Contents ParameterType="System.String" />
    </ParameterGroup>
    <Task>
      <Using Namespace="System" />
      <Using Namespace="System.IO" />
      <Code Type="Fragment" Language="cs"><![CDATA[File.WriteAllText(Path, Contents);]]></Code>
    </Task>
  </UsingTask>
  <!-- TODO 1 - END -->

  <!-- TODO 2 - BEGIN -->
  <!--<Target Name="GenerateHash" AfterTargets="PostBuildEvent"> -->
    <!--<Exec Command="xcopy /y $(TargetDir)*.* $(SolutionDir)..\deps\AssemblyProcessor\$(TargetFramework)\
cd $(SolutionDir)..\deps\AssemblyProcessor\$(TargetFramework)\
$(ILRepack) Stride.Core.AssemblyProcessor$(TargetExt) Mono.Cecil.dll Mono.Cecil.Mdb.dll Mono.Cecil.Pdb.dll Mono.Cecil.Rocks.dll Mono.Options.dll /out:Stride.Core.AssemblyProcessor.Packed$(TargetExt)"/> -->
    <!--<GetFileHash Files="$(SolutionDir)..\deps\AssemblyProcessor\$(TargetFramework)\Stride.Core.AssemblyProcessor.Packed$(TargetExt)"> -->
      <!--<Output
          TaskParameter="Hash"
          PropertyName="PackedAssemblyHash" /> -->
    <!--</GetFileHash> -->
    <!--<WriteAllText Path="$(SolutionDir)..\deps\AssemblyProcessor\$(TargetFramework)\Stride.Core.AssemblyProcessor.Packed$(TargetExt).hash" Contents="$(PackedAssemblyHash)"/> -->
  <!--</Target> -->
  <!-- TODO 3 - END -->

</Project>
